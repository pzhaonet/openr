<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>[Tutorial for steemr] Retrieving and Analyzing the Comment Data</title>
  <meta name="author" content="" />

  

  

  <meta name="generator" content="Hugo 0.53" />

  <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  
  <link href="/css/animate.css" rel="stylesheet">

  
  
    <link href="/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">
  


  
  <link href="/css/custom.css" rel="stylesheet">

  
  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png" />
  

  <link href="/css/owl.carousel.css" rel="stylesheet">
  <link href="/css/owl.theme.css" rel="stylesheet">

  <link rel="alternate" href="https://openr.netlify.com/index.xml" type="application/rss+xml" title="Open R">

  
  <meta property="og:title" content="[Tutorial for steemr] Retrieving and Analyzing the Comment Data" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/blog/steemr-tutorial-gcomment//" />
  <meta property="og:image" content="img/logo-small.png" />

  <script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>

</head>


  <body>

    <div id="all">

        <header>

          <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="https://openr.netlify.com/">
                    <img src="https://openr.netlify.com/img/logo-small.png" alt="[Tutorial for steemr] Retrieving and Analyzing the Comment Data logo" class="hidden-xs hidden-sm">
                    <img src="https://openr.netlify.com/img/logo-small.png" alt="[Tutorial for steemr] Retrieving and Analyzing the Comment Data logo" class="visible-xs visible-sm">
                    <span class="sr-only">[Tutorial for steemr] Retrieving and Analyzing the Comment Data - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fa fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  
                  <li class="dropdown">
                    
                    <a href="/">Home</a>
                    
                  </li>
                  
                  <li class="dropdown">
                    
                    <a href="/blog/">Blog</a>
                    
                  </li>
                  
                  <li class="dropdown">
                    
                    <a href="/faq/">FAQ</a>
                    
                  </li>
                  
                  <li class="dropdown">
                    
                    <a href="/contact/">Contact</a>
                    
                  </li>
                  
                  <li class="dropdown">
                    
                    <a href="/zh/">中文</a>
                    
                  </li>
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">

                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>

                </span>
                    </div>
                </form>

            </div>
            

        </div>
    </div>
    

</div>




        </header>

        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>[Tutorial for steemr] Retrieving and Analyzing the Comment Data</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-9" id="blog-post">

                        <p class="text-muted text-uppercase mb-small text-right">By <a href="#">Peng Zhao</a> | July 12, 2018</p>

                        <div id="post-content">
                          <h3 id="what-will-i-learn">What Will I Learn?</h3>

<ul>
<li>Using the function <code>gcomment()</code> to retrieve the comment data of a given ID.</li>
<li>Using other R functions to enhance and analyze the data retrieved by <code>gcomment()</code>.</li>
</ul>

<h3 id="requirements">Requirements</h3>

<ul>
<li>Windows/mac/Linux OS</li>
<li>R environment</li>
<li>R steemr package</li>
<li>RStudio IDE (recommended)</li>
</ul>

<h3 id="difficulty">Difficulty</h3>

<ul>
<li>Intermediate</li>
</ul>

<h3 id="basic-usage-of-gcomments">Basic usage of <code>gcomments()</code></h3>

<p>Load the 'steemr' package:</p>

<pre><code>require('steemr')

## Loading required package: steemr
</code></pre>

<p>The function name 'gcomment' means 'get comment data'. It is very easy to get the comments of a given ID if you have a SteemSQL user name and password.</p>

<p>Firstly, use the <code>ssql()</code> function to build a connection to SteemSQL:</p>

<pre><code>mysql &lt;- ssql(uid = your_steemsql_id, pwd = your_steemsql_password)
</code></pre>

<p>You have to replace <code>your_steemsql_id</code> and <code>your_steemsql_password</code> with your own.</p>

<p>Then, use the <code>gcomments()</code> function to retrieve the newest comment data of the given ID. Let's retrieve @dapeng's newest comments:</p>

<pre><code>mycmt &lt;- gcomments(id = 'dapeng', sql_con = mysql)
</code></pre>

<p>'mycmt' is a list with 2 elements, which are 'comment' and 'daily':</p>

<pre><code>length(mycmt)

## [1] 2

names(mycmt)

## [1] &quot;comment&quot; &quot;daily&quot;
</code></pre>

<p>Both of them are data frames. Have a look at what columns they have:</p>

<pre><code>names(mycmt$comment)

## [1] &quot;root_title&quot;   &quot;root_comment&quot; &quot;created&quot;      &quot;body&quot;        
## [5] &quot;date&quot;

names(mycmt$daily)

## [1] &quot;date&quot; &quot;Freq&quot;
</code></pre>

<p>The 'daily' dataframe is a summary, showing how many comments every day. Let's see what it is:</p>

<pre><code>mycmt$daily

##         date Freq
## 1 2018-06-30    4
## 2 2018-07-01   15
## 3 2018-07-02   10
## 4 2018-07-03   12
## 5 2018-07-04    5
## 6 2018-07-05   25
## 7 2018-07-06    3
</code></pre>

<p>We can view 'comment' by running:</p>

<pre><code>View(mycmt$comment)
</code></pre>

<p>In the topleft panel, a spread sheet appears on the tab 'mycmt$comment'. We can order or filter each column:</p>

<p><img src="https://github.com/pzhaonet/steemr-book/raw/master/img/gcomments-1.gif" style="display: block; margin: auto;" /></p>

<p>By default, <code>gcomments()</code> retrieves the comments in the last 7 days.</p>

<blockquote>
<p>Exercise 1: Get the comment records of your own or someone of interest. On which day did he/she post the most comments?</p>
</blockquote>

<h3 id="advanced-usage-of-gcomments">Advanced usage of <code>gcomments()</code></h3>

<p>Let's go further into <code>gcomments()</code>.</p>

<p>Multiple parameters are available for <code>gcomments()</code>:</p>

<ul>
<li><code>id</code> specifies the ID of interest, which is mandatory.</li>
<li><code>from</code> and <code>to</code> specifies the date range of the target comments. The date must be given in 'year-month-day' format.</li>
<li><code>select</code> specifies the columns to retrieve. By default, it queries four columns from the server: &quot;root_title&quot;, &quot;root_comment&quot;, &quot;created&quot;, and &quot;body&quot;. <code>select = '*'</code> retrieves all the columns. We will give an example.</li>
<li><code>sql_con</code> builds a connection to SteemSQL server.</li>
<li><code>if_plot</code> specifies whether to plot the daily comment number.</li>
<li><code>ylab</code> specifies the label of the y axis. It is valid only when if_plot is TRUE.</li>
</ul>

<p>Now let's query the @dapeng's comments from the beginning of 2016 and make a plot of the daily comment number.</p>

<pre><code>mycmt_all &lt;- gcomments(id = 'dapeng', 
                       sql_con = mysql, 
                       from = '2016-10-01', 
                       if_plot = TRUE)
</code></pre>

<p><img src="https://github.com/pzhaonet/steemr-book/raw/master/img/gcomments-1-1.png" style="display: block; margin: auto;" /></p>

<p>Right. @dapeng did not post any comment until the summer 2017.</p>

<pre><code>nrow(mycmt_all$comment)

## [1] 5359
</code></pre>

<p>He wrote 5359 comments in total.</p>

<p>Let's get the full information with all the columns of @dapeng's comments, and see what columns we can get.</p>

<pre><code>mycmt_full &lt;- gcomments(id = 'dapeng', 
                        sql_con = mysql, 
                        select = '*', 
                        from = '2016-10-01')
names(mycmt_full$comment)

##  [1] &quot;ID&quot;                         &quot;author&quot;                    
##  [3] &quot;permlink&quot;                   &quot;category&quot;                  
##  [5] &quot;parent_author&quot;              &quot;parent_permlink&quot;           
##  [7] &quot;title&quot;                      &quot;body&quot;                      
##  [9] &quot;json_metadata&quot;              &quot;last_update&quot;               
## [11] &quot;created&quot;                    &quot;active&quot;                    
## [13] &quot;last_payout&quot;                &quot;depth&quot;                     
## [15] &quot;children&quot;                   &quot;net_rshares&quot;               
## [17] &quot;abs_rshares&quot;                &quot;vote_rshares&quot;              
## [19] &quot;children_abs_rshares&quot;       &quot;cashout_time&quot;              
## [21] &quot;max_cashout_time&quot;           &quot;total_vote_weight&quot;         
## [23] &quot;reward_weight&quot;              &quot;total_payout_value&quot;        
## [25] &quot;curator_payout_value&quot;       &quot;author_rewards&quot;            
## [27] &quot;net_votes&quot;                  &quot;root_comment&quot;              
## [29] &quot;mode&quot;                       &quot;max_accepted_payout&quot;       
## [31] &quot;percent_steem_dollars&quot;      &quot;allow_replies&quot;             
## [33] &quot;allow_votes&quot;                &quot;allow_curation_rewards&quot;    
## [35] &quot;beneficiaries&quot;              &quot;url&quot;                       
## [37] &quot;root_title&quot;                 &quot;pending_payout_value&quot;      
## [39] &quot;total_pending_payout_value&quot; &quot;active_votes&quot;              
## [41] &quot;replies&quot;                    &quot;author_reputation&quot;         
## [43] &quot;promoted&quot;                   &quot;body_length&quot;               
## [45] &quot;reblogged_by&quot;               &quot;body_language&quot;             
## [47] &quot;TS&quot;                         &quot;date&quot;
</code></pre>

<blockquote>
<p>Exercise 2: Plot the daily comment number of an ID of your interest.</p>
</blockquote>

<h3 id="analysis-of-the-data-by-gcomments-examples">Analysis of the data by <code>gcomments()</code>: Examples</h3>

<p>With the data retrieved via <code>gcomments()</code>, we could produce a summary report:</p>

<pre><code>summary(mycmt_all$daily)

##       date                 Freq      
##  Min.   :2017-07-17   Min.   : 1.00  
##  1st Qu.:2017-10-08   1st Qu.: 8.00  
##  Median :2018-01-09   Median :14.00  
##  Mean   :2018-01-10   Mean   :16.75  
##  3rd Qu.:2018-04-15   3rd Qu.:24.00  
##  Max.   :2018-07-06   Max.   :91.00
</code></pre>

<p>It could be found that @dapeng left his first comment on 2017-07-17. Averagely he wrote 14 comments per day. On the busiest day he wrote 91 comments. Which day was it?</p>

<pre><code>mycmt_all$daily$date[which.max(mycmt_all$daily$Freq)]

## [1] &quot;2017-08-01&quot;
</code></pre>

<p>He does not remember why.</p>

<p>Was he so lazy that he repeated the same comment? We could use the <code>duplicated()</code> function to see if he has repeated comments.</p>

<pre><code>sum(duplicated(mycmt_all$comment$body))

## [1] 296
</code></pre>

<p>He had 296 duplicated comments! What were they? We can use the <code>table()</code> function to count the frequency of each duplicated comments, and order them descendingly.</p>

<pre><code>mytab &lt;- as.data.frame(table(mycmt_all$comment$body))
mytab &lt;- mytab[order(-mytab$Freq), ]
</code></pre>

<p>Then let's see the top 6 duplicated comments and their frequency:</p>

<pre><code>head(mytab)

##            Var1 Freq
## 401  Thank you!   51
## 470     Thanks!   35
## 3936     谢谢！   29
## 1                 18
## 483     Thanks.   13
## 3931       谢谢   13
</code></pre>

<p>There seemed 18 blank comments, which means he deleted them. The rest are the English and Chinese version of 'thanks'. It cannot be wrong if you repeat saying thanks, can it?</p>

<blockquote>
<p>Exercise 3: analyze the comment data you have got.</p>
</blockquote>
                        </div>
                        
                        

                    </div>
                    

                    

                    

                    <div class="col-md-3">

                        

                        

<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Search</h3>
    </div>

    <div class="panel-body">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" role="search">
            <div class="input-group">
                <input type="search" name="q" class="form-control" placeholder="Search">
                <input type="hidden" name="sitesearch" value="https://openr.netlify.com/">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>
                </span>
            </div>
        </form>
    </div>
</div>












<div class="panel sidebar-menu">
    <div class="panel-heading">
      <h3 class="panel-title">Tags</h3>
    </div>

    <div class="panel-body">
        <ul class="tag-cloud">
            
            <li><a href="https://openr.netlify.com/tags/advr"><i class="fa fa-tags"></i> advr</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/beginr"><i class="fa fa-tags"></i> beginr</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/bookdown"><i class="fa fa-tags"></i> bookdown</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/bookdownplus"><i class="fa fa-tags"></i> bookdownplus</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/markdown"><i class="fa fa-tags"></i> markdown</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/mindr"><i class="fa fa-tags"></i> mindr</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/news"><i class="fa fa-tags"></i> news</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/pinyin"><i class="fa fa-tags"></i> pinyin</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/r"><i class="fa fa-tags"></i> r</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/rmd"><i class="fa fa-tags"></i> rmd</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/rosr"><i class="fa fa-tags"></i> rosr</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/sinx"><i class="fa fa-tags"></i> sinx</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/steemr"><i class="fa fa-tags"></i> steemr</a>
            </li>
            
            <li><a href="https://openr.netlify.com/tags/tutorial"><i class="fa fa-tags"></i> tutorial</a>
            </li>
            
        </ul>
    </div>
</div>







                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
    <div class="container">

        
        <div class="col-md-4 col-sm-6">
            <h4>About us</h4>

            We are one.

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

        <div class="col-md-4 col-sm-6">

             
            <h4>Recent posts</h4>

            <div class="blog-entries">
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="https://openr.netlify.com/blog/sinx/">
                          
                            <img src="https://openr.netlify.com/img/banners/logo-sinx.png" class="img-responsive" alt="sinx: R fortunes in Chinese">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="https://openr.netlify.com/blog/sinx/">sinx: R fortunes in Chinese</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="https://openr.netlify.com/blog/rosr-shiny/">
                          
                            <img src="https://openr.netlify.com/img/banners/logo-rosr.png" class="img-responsive" alt="rosr News: a Shiny GUI and RStudio addin for choosing and creating sub-projects">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="https://openr.netlify.com/blog/rosr-shiny/">rosr News: a Shiny GUI and RStudio addin for choosing and creating sub-projects</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="https://openr.netlify.com/blog/rosr/">
                          
                            <img src="https://openr.netlify.com/img/banners/logo-rosr.png" class="img-responsive" alt="rosr: Create academic R markdown projects for open science and reproducible research">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="https://openr.netlify.com/blog/rosr/">rosr: Create academic R markdown projects for open science and reproducible research</a></h5>
                    </div>
                </div>
                
            </div>

            <hr class="hidden-md hidden-lg">
             

        </div>
        

        
        <div class="col-md-4 col-sm-6">

          <h4>Contact</h4>

            <strong>OpenR Team</strong>
      </p>
      


            <a href="/contact" class="btn btn-small btn-template-main">Go to contact page</a>

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

    </div>
    
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            
            <p class="pull-left">Copyright (c) 2019, OpenR Team; all rights reserved.</p>
            
            <p class="pull-right">
              Template by <a href="http://bootstrapious.com/free-templates">Bootstrapious</a>.
              

              Ported to Hugo by <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>
            </p>
        </div>
    </div>
</div>





    </div>
    

    
<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>

<script src="//maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script src="https://openr.netlify.com/js/hpneo.gmaps.js"></script>
<script src="https://openr.netlify.com/js/gmaps.init.js"></script>
<script src="https://openr.netlify.com/js/front.js"></script>


<script src="https://openr.netlify.com/js/owl.carousel.min.js"></script>


  </body>
</html>
